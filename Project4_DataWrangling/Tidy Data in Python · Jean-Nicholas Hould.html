<!DOCTYPE html>
<!-- saved from url=(0057)http://www.jeannicholashould.com/tidy-data-in-python.html -->
<html lang="en-us"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="google-site-verification" content="5btonT88L8X5eDqd-03PIQP7Q-Vh9cpsEKUBG9vmAsU">
  
  <title>
    
      Tidy Data in Python · Jean-Nicholas Hould
    
  </title>

  <!-- CSS -->
  <link href="./Tidy Data in Python · Jean-Nicholas Hould_files/classic-10_7.css" rel="stylesheet" type="text/css">
  <style type="text/css">
    #mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
  </style>
  <link rel="stylesheet" href="./Tidy Data in Python · Jean-Nicholas Hould_files/poole.css">
  <link rel="stylesheet" href="./Tidy Data in Python · Jean-Nicholas Hould_files/syntax.css">
  <link rel="stylesheet" href="./Tidy Data in Python · Jean-Nicholas Hould_files/lanyon.css">
  <link rel="stylesheet" href="./Tidy Data in Python · Jean-Nicholas Hould_files/custom.css">
  <link rel="stylesheet" href="./Tidy Data in Python · Jean-Nicholas Hould_files/css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://www.jeannicholashould.com/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="http://www.jeannicholashould.com/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.jeannicholashould.com/atom.xml">
  <script type="text/javascript" async="" src="./Tidy Data in Python · Jean-Nicholas Hould_files/analytics.js.download"></script><script type="text/javascript" async="" src="./Tidy Data in Python · Jean-Nicholas Hould_files/gtm.js.download"></script><script async="" src="./Tidy Data in Python · Jean-Nicholas Hould_files/script.js.download"></script><script type="text/javascript" async="" src="./Tidy Data in Python · Jean-Nicholas Hould_files/analytics.min.js.download"></script><script async="" src="./Tidy Data in Python · Jean-Nicholas Hould_files/gtm.js(1).download"></script><script src="./Tidy Data in Python · Jean-Nicholas Hould_files/jquery.min.js.download"></script>

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-K3RDXKL');</script>
  <!-- End Google Tag Manager -->
<script src="./Tidy Data in Python · Jean-Nicholas Hould_files/CKJS4.js.download" id="_ck_js_tag"></script><script type="text/javascript" src="./Tidy Data in Python · Jean-Nicholas Hould_files/jquery.min.js(1).download"></script></head>


  <body class="theme-base-08" style="" data-new-gr-c-s-check-loaded="14.1008.0" data-gr-ext-installed="">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>My journey learning data science.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="http://www.jeannicholashould.com/">Home</a>

    

    
    
      
        
      
    
      
    
      
    
      
    
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="http://www.jeannicholashould.com/about.html">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="http://www.jeannicholashould.com/archive.html">Archives</a>
        
      
    
      
    
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="http://www.jeannicholashould.com/marathons.html">Running</a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="http://www.jeannicholashould.com/talks.html">Talks</a>
        
      
    
  </nav>

  <div class="sidebar-item">
    <p>
      © 2020. All rights reserved.
    </p>
  </div>
</div>

    <script type="text/javascript">
!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
analytics.load("uCqkqZyD8gxfF8IVkLYQZGBqeszSRtzo");
analytics.page()
}}();
</script>


    <script>
  (function (w,i,d,g,e,t,s) {w[d] = w[d]||[];t= i.createElement(g);
    t.async=1;t.src=e;s=i.getElementsByTagName(g)[0];s.parentNode.insertBefore(t, s);
  })(window, document, '_gscq','script','//widgets.getsitecontrol.com/34832/script.js');
</script>
    <script type="text/javascript">
window.onload = function () {
  var links = document.links;

  for (var i = 0, linksLength = links.length; i < linksLength; i++) {
     if (links[i].hostname != window.location.hostname) {
         links[i].target = '_blank';
     } 
  }
}
</script>
   
    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="http://www.jeannicholashould.com/" title="Home">Jean-Nicholas Hould</a>
            <small>On Data Science</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">Tidy Data in Python</h1>
  <span class="post-date">06 Dec 2016</span>
  <p>I recently came across a paper named <a href="http://vita.had.co.nz/papers/tidy-data.pdf" target="_blank">Tidy Data</a> by Hadley Wickham. Published back in 2014, the paper focuses on one aspect of cleaning up data, tidying data: structuring datasets to facilitate analysis. Through the paper, Wickham demonstrates how any dataset can be structured in a standardized way prior to analysis. He presents in detail the different types of data sets and how to wrangle them into a standard format.</p>

<p>As a data scientist, I think you should get very familiar with this standardized structure of a dataset. Data cleaning is one the most frequent task in data science. No matter what kind of data you are dealing with or what kind of analysis you are performing, you will have to clean the data at some point. Tidying your data in a standard format makes things easier down the road. You can reuse a standard set of tools across your different analysis.</p>

<p>In this post, I will summarize some tidying examples Wickham uses in his paper and I will demonstrate how to do so using the Python <a href="http://pandas.pydata.org/" target="_blank">pandas</a> library.</p>

<h2 id="defining-tidy-data">Defining tidy data</h2>
<p>The structure Wickham defines as tidy has the following attributes:</p>

<ul>
  <li>Each <em>variable</em> forms a column and contains <em>values</em></li>
  <li>Each <em>observation</em> forms a row</li>
  <li>Each type of <em>observational unit</em> forms a table</li>
</ul>

<p>A few definitions:</p>

<ul>
  <li>Variable: A measurement or an attribute. <small><em>Height, weight, sex, etc.</em></small></li>
  <li>Value: The actual measurement or attribute. <small><em>152 cm, 80 kg, female, etc.</em></small></li>
  <li>Observation: All values measure on the same unit. <small><em>Each person.</em></small></li>
</ul>

<p>An example of a <em>messy dataset</em>:</p>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th></th>
      <th>Treatment A</th>
      <th>Treatment B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>John Smith</th>
      <td>-</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Jane Doe</th>
      <td>16</td>
      <td>11</td>
    </tr>
    <tr>
      <th>Mary Johnson</th>
      <td>3</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<p>An example of a <em>tidy dataset</em>:</p>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>Name</th>
      <th>Treatment</th>
      <th>Result</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>John Smith</th>
      <td>a</td>
      <td>-</td>
    </tr>
    <tr>
      <th>Jane Doe</th>
      <td>a</td>
      <td>16</td>
    </tr>
    <tr>
      <th>Mary Johnson</th>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <th>John Smith</th>
      <td>b</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Jane Doe</th>
      <td>b</td>
      <td>11</td>
    </tr>
    <tr>
      <th>Mary Johnson</th>
      <td>b</td>
      <td>1</td>
    </tr>    
  </tbody>
</table>
</div>

<h2 id="tidying-messy-datasets">Tidying messy datasets</h2>

<p>Through the following examples extracted from Wickham’s paper, we’ll wrangle messy datasets into the tidy format. The goal here is not to analyze the datasets but rather prepare them in a standardized way prior to the analysis. These are the five types of messy datasets we’ll tackle:</p>

<ul>
  <li>Column headers are values, not variable names.</li>
  <li>Multiple variables are stored in one column.</li>
  <li>Variables are stored in both rows and columns.</li>
  <li>Multiple types of observational units are stored in the same table.</li>
  <li>A single observational unit is stored in multiple tables.</li>
</ul>

<p><em>Note: All of the code presented in this post is available on <a href="https://github.com/nickhould/tidy-data-python" target="_blank">Github</a>.</em></p>

<h3 id="column-headers-are-values-not-variable-names">Column headers are values, not variable names</h3>

<h4 id="pew-research-center-dataset">Pew Research Center Dataset</h4>
<p>This dataset explores the relationship between income and religion.</p>

<p>Problem: The columns headers are composed of the possible income values.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">listdir</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">isfile</span><span class="p">,</span> <span class="n">join</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"./data/pew-raw.csv"</span><span class="p">)</span>
<span class="n">df</span></code></pre></figure>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>religion</th>
      <th>&lt;$10k</th>
      <th>$10-20k</th>
      <th>$20-30k</th>
      <th>$30-40k</th>
      <th>$40-50k</th>
      <th>$50-75k</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Agnostic</td>
      <td>27</td>
      <td>34</td>
      <td>60</td>
      <td>81</td>
      <td>76</td>
      <td>137</td>
    </tr>
    <tr>
      <td>Atheist</td>
      <td>12</td>
      <td>27</td>
      <td>37</td>
      <td>52</td>
      <td>35</td>
      <td>70</td>
    </tr>
    <tr>
      <td>Buddhist</td>
      <td>27</td>
      <td>21</td>
      <td>30</td>
      <td>34</td>
      <td>33</td>
      <td>58</td>
    </tr>
    <tr>
      <td>Catholic</td>
      <td>418</td>
      <td>617</td>
      <td>732</td>
      <td>670</td>
      <td>638</td>
      <td>1116</td>
    </tr>
    <tr>
      <td>Dont know/refused</td>
      <td>15</td>
      <td>14</td>
      <td>15</td>
      <td>11</td>
      <td>10</td>
      <td>35</td>
    </tr>
    <tr>
      <td>Evangelical Prot</td>
      <td>575</td>
      <td>869</td>
      <td>1064</td>
      <td>982</td>
      <td>881</td>
      <td>1486</td>
    </tr>
    <tr>
      <td>Hindu</td>
      <td>1</td>
      <td>9</td>
      <td>7</td>
      <td>9</td>
      <td>11</td>
      <td>34</td>
    </tr>
    <tr>
      <td>Historically Black Prot</td>
      <td>228</td>
      <td>244</td>
      <td>236</td>
      <td>238</td>
      <td>197</td>
      <td>223</td>
    </tr>
    <tr>
      <td>Jehovahs Witness</td>
      <td>20</td>
      <td>27</td>
      <td>24</td>
      <td>24</td>
      <td>21</td>
      <td>30</td>
    </tr>
    <tr>
      <td>Jewish</td>
      <td>19</td>
      <td>19</td>
      <td>25</td>
      <td>25</td>
      <td>30</td>
      <td>95</td>
    </tr>
  </tbody>
</table>
</div>

<p>A tidy version of this dataset is one in which the income values would not be columns headers but rather values in an <code class="language-plaintext highlighter-rouge">income</code> column. In order to tidy this dataset, we need to <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.melt.html" target="_blank">melt</a> it. The <em>pandas</em> library has a built-in function that allows to do just that. It “unpivots” a DataFrame from a wide format to a long format. We’ll reuse this function a few times through the post.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">formatted_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
                       <span class="p">[</span><span class="s">"religion"</span><span class="p">],</span>
                       <span class="n">var_name</span><span class="o">=</span><span class="s">"income"</span><span class="p">,</span>
                       <span class="n">value_name</span><span class="o">=</span><span class="s">"freq"</span><span class="p">)</span>
<span class="n">formatted_df</span> <span class="o">=</span> <span class="n">formatted_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">"religion"</span><span class="p">])</span>
<span class="n">formatted_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span></code></pre></figure>

<p>This outputs a tidy version of the dataset:</p>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>religion</th>
      <th>income</th>
      <th>freq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Agnostic</td>
      <td>&lt;$10k</td>
      <td>27</td>
    </tr>
    <tr>
      <td>Agnostic</td>
      <td>$30-40k</td>
      <td>81</td>
    </tr>
    <tr>
      <td>Agnostic</td>
      <td>$40-50k</td>
      <td>76</td>
    </tr>
    <tr>
      <td>Agnostic</td>
      <td>$50-75k</td>
      <td>137</td>
    </tr>
    <tr>
      <td>Agnostic</td>
      <td>$10-20k</td>
      <td>34</td>
    </tr>
    <tr>
      <td>Agnostic</td>
      <td>$20-30k</td>
      <td>60</td>
    </tr>
    <tr>
      <td>Atheist</td>
      <td>$40-50k</td>
      <td>35</td>
    </tr>
    <tr>
      <td>Atheist</td>
      <td>$20-30k</td>
      <td>37</td>
    </tr>
    <tr>
      <td>Atheist</td>
      <td>$10-20k</td>
      <td>27</td>
    </tr>
    <tr>
      <td>Atheist</td>
      <td>$30-40k</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="billboard-top-100-dataset">Billboard Top 100 Dataset</h4>

<p>This dataset represents the weekly rank of songs from the moment they enter the Billboard Top 100 to the subsequent 75 weeks.</p>

<p>Problems:</p>

<ul>
  <li>The columns headers are composed of values: the week number (<code class="language-plaintext highlighter-rouge">x1st.week</code>, …)</li>
  <li>If a song is in the Top 100 for less than 75 weeks, the remaining columns are filled with missing values.</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"./data/billboard.csv"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">"mac_latin2"</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span></code></pre></figure>

<div>
<table border="1" class="dataframe" style="table-layout: fixed;">
  <thead style="word-wrap: break-word;">
    <tr style="text-align: left;">
      <th>year</th>
      <th>artist.inverted</th>
      <th>track</th>
      <th>time</th>
      <th>genre</th>
      <th>date.entered</th>
      <th>date.peaked</th>
      <th>x1st.week</th>
      <th>x2nd.week</th>
      <th>...</th>
    </tr>
  </thead>
  <tbody style="word-wrap: break-word;">
    <tr>
      <td>2000</td>
      <td>Destiny's Child</td>
      <td>Independent Women Part I</td>
      <td>3:38</td>
      <td>Rock</td>
      <td>2000-09-23</td>
      <td>2000-11-18</td>
      <td>78</td>
      <td>63.0</td>
      <td>...</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>Santana</td>
      <td>Maria, Maria</td>
      <td>4:18</td>
      <td>Rock</td>
      <td>2000-02-12</td>
      <td>2000-04-08</td>
      <td>15</td>
      <td>8.0</td>
      <td>...</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>Savage Garden</td>
      <td>I Knew I Loved You</td>
      <td>4:07</td>
      <td>Rock</td>
      <td>1999-10-23</td>
      <td>2000-01-29</td>
      <td>71</td>
      <td>48.0</td>
      <td>...</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>Madonna</td>
      <td>Music</td>
      <td>3:45</td>
      <td>Rock</td>
      <td>2000-08-12</td>
      <td>2000-09-16</td>
      <td>41</td>
      <td>23.0</td>
      <td>...</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>Aguilera, Christina</td>
      <td>Come On Over Baby (All I Want Is You)</td>
      <td>3:38</td>
      <td>Rock</td>
      <td>2000-08-05</td>
      <td>2000-10-14</td>
      <td>57</td>
      <td>47.0</td>
      <td>...</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>Janet</td>
      <td>Doesn't Really Matter</td>
      <td>4:17</td>
      <td>Rock</td>
      <td>2000-06-17</td>
      <td>2000-08-26</td>
      <td>59</td>
      <td>52.0</td>
      <td>...</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>Destiny's Child</td>
      <td>Say My Name</td>
      <td>4:31</td>
      <td>Rock</td>
      <td>1999-12-25</td>
      <td>2000-03-18</td>
      <td>83</td>
      <td>83.0</td>
      <td>...</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>Iglesias, Enrique</td>
      <td>Be With You</td>
      <td>3:36</td>
      <td>Latin</td>
      <td>2000-04-01</td>
      <td>2000-06-24</td>
      <td>63</td>
      <td>45.0</td>
      <td>...</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>Sisqo</td>
      <td>Incomplete</td>
      <td>3:52</td>
      <td>Rock</td>
      <td>2000-06-24</td>
      <td>2000-08-12</td>
      <td>77</td>
      <td>66.0</td>
      <td>...</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>Lonestar</td>
      <td>Amazed</td>
      <td>4:25</td>
      <td>Country</td>
      <td>1999-06-05</td>
      <td>2000-03-04</td>
      <td>81</td>
      <td>54.0</td>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>

<p>A tidy version of this dataset is one without the week’s numbers as columns but rather as values of a single column. In order to do so, we’ll <em>melt</em> the weeks columns into a single <code class="language-plaintext highlighter-rouge">date</code> column. We will create one row per week for each record. If there is no data for the given week, we will not create a row.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Melting
</span><span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s">"year"</span><span class="p">,</span>
           <span class="s">"artist.inverted"</span><span class="p">,</span>
           <span class="s">"track"</span><span class="p">,</span>
           <span class="s">"time"</span><span class="p">,</span>
           <span class="s">"genre"</span><span class="p">,</span>
           <span class="s">"date.entered"</span><span class="p">,</span>
           <span class="s">"date.peaked"</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="n">id_vars</span><span class="o">=</span><span class="n">id_vars</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s">"week"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s">"rank"</span><span class="p">)</span>

<span class="c1"># Formatting 
</span><span class="n">df</span><span class="p">[</span><span class="s">"week"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'week'</span><span class="p">]</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s">'(</span><span class="err">\</span><span class="s">d+)'</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">"rank"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"rank"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Cleaning out unnecessary rows
</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Create "date" columns
</span><span class="n">df</span><span class="p">[</span><span class="s">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'date.entered'</span><span class="p">])</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'week'</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s">'w'</span><span class="p">)</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">DateOffset</span><span class="p">(</span><span class="n">weeks</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">"year"</span><span class="p">,</span> 
         <span class="s">"artist.inverted"</span><span class="p">,</span>
         <span class="s">"track"</span><span class="p">,</span>
         <span class="s">"time"</span><span class="p">,</span>
         <span class="s">"genre"</span><span class="p">,</span>
         <span class="s">"week"</span><span class="p">,</span>
         <span class="s">"rank"</span><span class="p">,</span>
         <span class="s">"date"</span><span class="p">]]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">"year"</span><span class="p">,</span><span class="s">"artist.inverted"</span><span class="p">,</span><span class="s">"track"</span><span class="p">,</span><span class="s">"week"</span><span class="p">,</span><span class="s">"rank"</span><span class="p">])</span>

<span class="c1"># Assigning the tidy dataset to a variable for future usage
</span><span class="n">billboard</span> <span class="o">=</span> <span class="n">df</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span></code></pre></figure>

<p>A tidier version of the dataset is shown below. There is still a lot of repetition of the song details: the track name, time and genre. For this reason, this dataset is still not completely tidy as per Wickham’s definition. We will address this in the next example.</p>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>year</th>
      <th>artist.inverted</th>
      <th>track</th>
      <th>time</th>
      <th>genre</th>
      <th>week</th>
      <th>rank</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep Ya Head Up II)</td>
      <td>4:22</td>
      <td>Rap</td>
      <td>1</td>
      <td>87</td>
      <td>2000-02-26</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep Ya Head Up II)</td>
      <td>4:22</td>
      <td>Rap</td>
      <td>2</td>
      <td>82</td>
      <td>2000-03-04</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep Ya Head Up II)</td>
      <td>4:22</td>
      <td>Rap</td>
      <td>3</td>
      <td>72</td>
      <td>2000-03-11</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep Ya Head Up II)</td>
      <td>4:22</td>
      <td>Rap</td>
      <td>4</td>
      <td>77</td>
      <td>2000-03-18</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep Ya Head Up II)</td>
      <td>4:22</td>
      <td>Rap</td>
      <td>5</td>
      <td>87</td>
      <td>2000-03-25</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep Ya Head Up II)</td>
      <td>4:22</td>
      <td>Rap</td>
      <td>6</td>
      <td>94</td>
      <td>2000-04-01</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep Ya Head Up II)</td>
      <td>4:22</td>
      <td>Rap</td>
      <td>7</td>
      <td>99</td>
      <td>2000-04-08</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>2Ge+her</td>
      <td>The Hardest Part Of Breaking Up (Is Getting Ba...</td>
      <td>3:15</td>
      <td>R&amp;B</td>
      <td>1</td>
      <td>91</td>
      <td>2000-09-02</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>2Ge+her</td>
      <td>The Hardest Part Of Breaking Up (Is Getting Ba...</td>
      <td>3:15</td>
      <td>R&amp;B</td>
      <td>2</td>
      <td>87</td>
      <td>2000-09-09</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>2Ge+her</td>
      <td>The Hardest Part Of Breaking Up (Is Getting Ba...</td>
      <td>3:15</td>
      <td>R&amp;B</td>
      <td>3</td>
      <td>92</td>
      <td>2000-09-16</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="multiple-types-in-one-table">Multiple types in one table</h3>

<p>Following up on the Billboard dataset, we’ll now address the repetition problem of the previous table.</p>

<p>Problems:</p>

<ul>
  <li>Multiple observational units (the <code class="language-plaintext highlighter-rouge">song</code> and its <code class="language-plaintext highlighter-rouge">rank</code>) in a single table.</li>
</ul>

<p>We’ll first create a <code class="language-plaintext highlighter-rouge">songs</code> table which contains the details of each song:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">songs_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s">"year"</span><span class="p">,</span> <span class="s">"artist.inverted"</span><span class="p">,</span> <span class="s">"track"</span><span class="p">,</span> <span class="s">"time"</span><span class="p">,</span> <span class="s">"genre"</span><span class="p">]</span>
<span class="n">songs</span> <span class="o">=</span> <span class="n">billboard</span><span class="p">[</span><span class="n">songs_cols</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">songs</span> <span class="o">=</span> <span class="n">songs</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">songs</span><span class="p">[</span><span class="s">"song_id"</span><span class="p">]</span> <span class="o">=</span> <span class="n">songs</span><span class="o">.</span><span class="n">index</span>
<span class="n">songs</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span></code></pre></figure>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>year</th>
      <th>artist.inverted</th>
      <th>track</th>
      <th>time</th>
      <th>genre</th>
      <th>song_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep Ya Head Up II)</td>
      <td>4:22</td>
      <td>Rap</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>2Ge+her</td>
      <td>The Hardest Part Of Breaking Up (Is Getting Ba...</td>
      <td>3:15</td>
      <td>R&amp;B</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Kryptonite</td>
      <td>3:53</td>
      <td>Rock</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Loser</td>
      <td>4:24</td>
      <td>Rock</td>
      <td>3</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>504 Boyz</td>
      <td>Wobble Wobble</td>
      <td>3:35</td>
      <td>Rap</td>
      <td>4</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>98�</td>
      <td>Give Me Just One Night (Una Noche)</td>
      <td>3:24</td>
      <td>Rock</td>
      <td>5</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>A*Teens</td>
      <td>Dancing Queen</td>
      <td>3:44</td>
      <td>Pop</td>
      <td>6</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>Aaliyah</td>
      <td>I Don't Wanna</td>
      <td>4:15</td>
      <td>Rock</td>
      <td>7</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>Aaliyah</td>
      <td>Try Again</td>
      <td>4:03</td>
      <td>Rock</td>
      <td>8</td>
    </tr>
    <tr>
      <td>2000</td>
      <td>Adams, Yolanda</td>
      <td>Open My Heart</td>
      <td>5:30</td>
      <td>Gospel</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>

<p>We’ll then create a <code class="language-plaintext highlighter-rouge">ranks</code> table which only contains the <code class="language-plaintext highlighter-rouge">song_id</code>, <code class="language-plaintext highlighter-rouge">date</code> and the <code class="language-plaintext highlighter-rouge">rank</code>.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">ranks</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">billboard</span><span class="p">,</span> <span class="n">songs</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s">"year"</span><span class="p">,</span><span class="s">"artist.inverted"</span><span class="p">,</span> <span class="s">"track"</span><span class="p">,</span> <span class="s">"time"</span><span class="p">,</span> <span class="s">"genre"</span><span class="p">])</span>
<span class="n">ranks</span> <span class="o">=</span> <span class="n">ranks</span><span class="p">[[</span><span class="s">"song_id"</span><span class="p">,</span> <span class="s">"date"</span><span class="p">,</span><span class="s">"rank"</span><span class="p">]]</span>
<span class="n">ranks</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span></code></pre></figure>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>song_id</th>
      <th>date</th>
      <th>rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2000-02-26</td>
      <td>87</td>
    </tr>
    <tr>
      <td>0</td>
      <td>2000-03-04</td>
      <td>82</td>
    </tr>
    <tr>
      <td>0</td>
      <td>2000-03-11</td>
      <td>72</td>
    </tr>
    <tr>
      <td>0</td>
      <td>2000-03-18</td>
      <td>77</td>
    </tr>
    <tr>
      <td>0</td>
      <td>2000-03-25</td>
      <td>87</td>
    </tr>
    <tr>
      <td>0</td>
      <td>2000-04-01</td>
      <td>94</td>
    </tr>
    <tr>
      <td>0</td>
      <td>2000-04-08</td>
      <td>99</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2000-09-02</td>
      <td>91</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2000-09-09</td>
      <td>87</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2000-09-16</td>
      <td>92</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="multiple-variables-stored-in-one-column">Multiple variables stored in one column</h3>

<h4 id="tubercolosis-records-from-world-health-organization">Tubercolosis Records from World Health Organization</h4>
<p>This dataset documents the count of confirmed tuberculosis cases by country, year, age and sex.</p>

<p>Problems:</p>

<ul>
  <li>Some columns contain multiple values: sex and age.</li>
  <li>Mixture of zeros and missing values <code class="language-plaintext highlighter-rouge">NaN</code>. This is due to the data collection process and the distinction is important for this dataset.</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"./data/tb-raw.csv"</span><span class="p">)</span>
<span class="n">df</span></code></pre></figure>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>country</th>
      <th>year</th>
      <th>m014</th>
      <th>m1524</th>
      <th>m2534</th>
      <th>m3544</th>
      <th>m4554</th>
      <th>m5564</th>
      <th>m65</th>
      <th>mu</th>
      <th>f014</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>AD</td>
      <td>2000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>AE</td>
      <td>2000</td>
      <td>2</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>5</td>
      <td>12</td>
      <td>10</td>
      <td>NaN</td>
      <td>3</td>
    </tr>
    <tr>
      <td>AF</td>
      <td>2000</td>
      <td>52</td>
      <td>228</td>
      <td>183</td>
      <td>149</td>
      <td>129</td>
      <td>94</td>
      <td>80</td>
      <td>NaN</td>
      <td>93</td>
    </tr>
    <tr>
      <td>AG</td>
      <td>2000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <td>AL</td>
      <td>2000</td>
      <td>2</td>
      <td>19</td>
      <td>21</td>
      <td>14</td>
      <td>24</td>
      <td>19</td>
      <td>16</td>
      <td>NaN</td>
      <td>3</td>
    </tr>
    <tr>
      <td>AM</td>
      <td>2000</td>
      <td>2</td>
      <td>152</td>
      <td>130</td>
      <td>131</td>
      <td>63</td>
      <td>26</td>
      <td>21</td>
      <td>NaN</td>
      <td>1</td>
    </tr>
    <tr>
      <td>AN</td>
      <td>2000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <td>AO</td>
      <td>2000</td>
      <td>186</td>
      <td>999</td>
      <td>1003</td>
      <td>912</td>
      <td>482</td>
      <td>312</td>
      <td>194</td>
      <td>NaN</td>
      <td>247</td>
    </tr>
    <tr>
      <td>AR</td>
      <td>2000</td>
      <td>97</td>
      <td>278</td>
      <td>594</td>
      <td>402</td>
      <td>419</td>
      <td>368</td>
      <td>330</td>
      <td>NaN</td>
      <td>121</td>
    </tr>
    <tr>
      <td>AS</td>
      <td>2000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>In order to tidy this dataset, we need to remove the different values from the header and unpivot them into rows. We’ll first need to melt the <code class="language-plaintext highlighter-rouge">sex + age group</code> columns into a single one. Once we have that single column, we’ll derive three columns from it: <code class="language-plaintext highlighter-rouge">sex</code>, <code class="language-plaintext highlighter-rouge">age_lower</code> and <code class="language-plaintext highlighter-rouge">age_upper</code>. With those, we’ll be able to properly build a tidy dataset.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s">"country"</span><span class="p">,</span><span class="s">"year"</span><span class="p">],</span> <span class="n">value_name</span><span class="o">=</span><span class="s">"cases"</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s">"sex_and_age"</span><span class="p">)</span>

<span class="c1"># Extract Sex, Age lower bound and Age upper bound group
</span><span class="n">tmp_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"sex_and_age"</span><span class="p">]</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s">"(</span><span class="err">\</span><span class="s">D)(</span><span class="err">\</span><span class="s">d+)(</span><span class="err">\</span><span class="s">d{2})"</span><span class="p">)</span>    

<span class="c1"># Name columns
</span><span class="n">tmp_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">"sex"</span><span class="p">,</span> <span class="s">"age_lower"</span><span class="p">,</span> <span class="s">"age_upper"</span><span class="p">]</span>

<span class="c1"># Create `age`column based on `age_lower` and `age_upper`
</span><span class="n">tmp_df</span><span class="p">[</span><span class="s">"age"</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp_df</span><span class="p">[</span><span class="s">"age_lower"</span><span class="p">]</span> <span class="o">+</span> <span class="s">"-"</span> <span class="o">+</span> <span class="n">tmp_df</span><span class="p">[</span><span class="s">"age_upper"</span><span class="p">]</span>

<span class="c1"># Merge 
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">tmp_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Drop unnecessary columns and rows
</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'sex_and_age'</span><span class="p">,</span><span class="s">"age_lower"</span><span class="p">,</span><span class="s">"age_upper"</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">"country"</span><span class="p">,</span> <span class="s">"year"</span><span class="p">,</span> <span class="s">"sex"</span><span class="p">,</span> <span class="s">"age"</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span></code></pre></figure>

<p>This results in a <em>tidy dataset</em>.</p>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>country</th>
      <th>year</th>
      <th>cases</th>
      <th>sex</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>AD</td>
      <td>2000</td>
      <td>0</td>
      <td>m</td>
      <td>0-14</td>
    </tr>
    <tr>
      <td>AD</td>
      <td>2000</td>
      <td>0</td>
      <td>m</td>
      <td>15-24</td>
    </tr>
    <tr>
      <td>AD</td>
      <td>2000</td>
      <td>1</td>
      <td>m</td>
      <td>25-34</td>
    </tr>
    <tr>
      <td>AD</td>
      <td>2000</td>
      <td>0</td>
      <td>m</td>
      <td>35-44</td>
    </tr>
    <tr>
      <td>AD</td>
      <td>2000</td>
      <td>0</td>
      <td>m</td>
      <td>45-54</td>
    </tr>
    <tr>
      <td>AD</td>
      <td>2000</td>
      <td>0</td>
      <td>m</td>
      <td>55-64</td>
    </tr>
    <tr>
      <td>AE</td>
      <td>2000</td>
      <td>3</td>
      <td>f</td>
      <td>0-14</td>
    </tr>
    <tr>
      <td>AE</td>
      <td>2000</td>
      <td>2</td>
      <td>m</td>
      <td>0-14</td>
    </tr>
    <tr>
      <td>AE</td>
      <td>2000</td>
      <td>4</td>
      <td>m</td>
      <td>15-24</td>
    </tr>
    <tr>
      <td>AE</td>
      <td>2000</td>
      <td>4</td>
      <td>m</td>
      <td>25-34</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="variables-are-stored-in-both-rows-and-columns">Variables are stored in both rows and columns</h3>

<h4 id="global-historical-climatology-network-dataset">Global Historical Climatology Network Dataset</h4>
<p>This dataset represents the daily weather records for a weather station (MX17004) in Mexico for five months in 2010.</p>

<p>Problems:</p>

<ul>
  <li>Variables are stored in both rows (<code class="language-plaintext highlighter-rouge">tmin</code>, <code class="language-plaintext highlighter-rouge">tmax</code>) and columns (<code class="language-plaintext highlighter-rouge">days</code>).</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"./data/weather-raw.csv"</span><span class="p">)</span>
<span class="n">df</span></code></pre></figure>

<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>id</th>
      <th>year</th>
      <th>month</th>
      <th>element</th>
      <th>d1</th>
      <th>d2</th>
      <th>d3</th>
      <th>d4</th>
      <th>d5</th>
      <th>d6</th>
      <th>d7</th>
      <th>d8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>MX17004</td>
      <td>2010</td>
      <td>1</td>
      <td>tmax</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>MX17004</td>
      <td>2010</td>
      <td>1</td>
      <td>tmin</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>MX17004</td>
      <td>2010</td>
      <td>2</td>
      <td>tmax</td>
      <td>NaN</td>
      <td>27.3</td>
      <td>24.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>MX17004</td>
      <td>2010</td>
      <td>2</td>
      <td>tmin</td>
      <td>NaN</td>
      <td>14.4</td>
      <td>14.4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>MX17004</td>
      <td>2010</td>
      <td>3</td>
      <td>tmax</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>32.1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>MX17004</td>
      <td>2010</td>
      <td>3</td>
      <td>tmin</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>MX17004</td>
      <td>2010</td>
      <td>4</td>
      <td>tmax</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>MX17004</td>
      <td>2010</td>
      <td>4</td>
      <td>tmin</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>MX17004</td>
      <td>2010</td>
      <td>5</td>
      <td>tmax</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>MX17004</td>
      <td>2010</td>
      <td>5</td>
      <td>tmin</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>In order to make this dataset tidy, we want to move the three misplaced variables (<code class="language-plaintext highlighter-rouge">tmin</code>, <code class="language-plaintext highlighter-rouge">tmax</code> and <code class="language-plaintext highlighter-rouge">days</code>) as three individual columns: <code class="language-plaintext highlighter-rouge">tmin</code>. <code class="language-plaintext highlighter-rouge">tmax</code> and <code class="language-plaintext highlighter-rouge">date</code>.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Extracting day
</span><span class="n">df</span><span class="p">[</span><span class="s">"day"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"day_raw"</span><span class="p">]</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s">"d(</span><span class="err">\</span><span class="s">d+)"</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  
<span class="n">df</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"MX17004"</span>

<span class="c1"># To numeric values
</span><span class="n">df</span><span class="p">[[</span><span class="s">"year"</span><span class="p">,</span><span class="s">"month"</span><span class="p">,</span><span class="s">"day"</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">"year"</span><span class="p">,</span><span class="s">"month"</span><span class="p">,</span><span class="s">"day"</span><span class="p">]]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s">'ignore'</span><span class="p">))</span>

<span class="c1"># Creating a date from the different columns
</span><span class="k">def</span> <span class="nf">create_date_from_year_month_day</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s">"year"</span><span class="p">],</span> <span class="n">month</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"month"</span><span class="p">]),</span> <span class="n">day</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="s">"day"</span><span class="p">])</span>

<span class="n">df</span><span class="p">[</span><span class="s">"date"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">create_date_from_year_month_day</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'year'</span><span class="p">,</span><span class="s">"month"</span><span class="p">,</span><span class="s">"day"</span><span class="p">,</span> <span class="s">"day_raw"</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Unmelting column "element"
</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">"id"</span><span class="p">,</span><span class="s">"date"</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="s">"element"</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">"value"</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df</span></code></pre></figure>

<div>
  <table border="1" class="dataframe">
    <thead>
      <tr style="text-align: left;">
        <th>id</th>
        <th>date</th>
        <th>tmax</th>
        <th>tmin</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>MX17004</td>
        <td>2010-02-02</td>
        <td>27.3</td>
        <td>14.4</td>
      </tr>
      <tr>
        <td>MX17004</td>
        <td>2010-02-03</td>
        <td>24.1</td>
        <td>14.4</td>
      </tr>
      <tr>
        <td>MX17004</td>
        <td>2010-03-05</td>
        <td>32.1</td>
        <td>14.2</td>
      </tr>
    </tbody>
  </table>
</div>

<h3 id="one-type-in-multiple-tables">One type in multiple tables</h3>

<p>Dataset: Illinois Male Baby Names for the year 2014/2015.</p>

<p>Problems:</p>

<ul>
  <li>The data is spread across multiple tables/files.</li>
  <li>The “Year” variable is present in the file name.</li>
</ul>

<p>In order to load those different files into a single DataFrame, we can run a custom script that will append the files together. Furthermore, we’ll need to extract the “Year” variable from the file name.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">extract_year</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">".+(</span><span class="err">\</span><span class="s">d{4})"</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span> 
    <span class="k">if</span> <span class="n">match</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    
<span class="n">path</span> <span class="o">=</span> <span class="s">'./data'</span>
<span class="n">allFiles</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s">"/201*-baby-names-illinois.csv"</span><span class="p">)</span>
<span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">df_list</span><span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">file_</span> <span class="ow">in</span> <span class="n">allFiles</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s">"year"</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_year</span><span class="p">(</span><span class="n">file_</span><span class="p">)</span>
    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span></code></pre></figure>

<div>
    <table border="1" class="dataframe">
      <thead>
            <tr style="text-align: left;">
                <th>rank</th>
                <th>name</th>
                <th>frequency</th>
                <th>sex</th>
                <th>year</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>Noah</td>
                <td>837</td>
                <td>Male</td>
                <td>2014</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Alexander</td>
                <td>747</td>
                <td>Male</td>
                <td>2014</td>
            </tr>
            <tr>
                <td>3</td>
                <td>William</td>
                <td>687</td>
                <td>Male</td>
                <td>2014</td>
            </tr>
            <tr>
                <td>4</td>
                <td>Michael</td>
                <td>680</td>
                <td>Male</td>
                <td>2014</td>
            </tr>
            <tr>
                <td>5</td>
                <td>Liam</td>
                <td>670</td>
                <td>Male</td>
                <td>2014</td>
            </tr>
        </tbody>
    </table>
</div>

<h2 id="final-thoughts">Final Thoughts</h2>

<p>In this post, I focused on one aspect of Wickham’s paper, the data manipulation part. My main goal was to demonstrate the data manipulations in Python. It’s important to mention that there is a significant section of his paper that covers the tools and visualizations from which you can benefit by tidying your dataset. I did not cover those in this post.</p>

<p>Overall, I enjoyed preparing this post and wrangling the datasets into a streamlined format. The defined format makes it easier to query and filter the data. This approach makes it easier to reuse libraries and code across analysis. It also makes it easier to share a dataset with other data analysts.</p>

</div>

<!-- Convertkit - Start -->
<div><div class="ck_form_container ck_inline" data-ck-version="6">
  
<div class="ck_form ck_vertical_subscription_form ck_horizontal">
  <div class="ck_form_content">
    <h3 class="ck_form_title">Learn How to Get Started in Data Science</h3>
    <div class="ck_description">
      <span class="ck_image">
        
      </span>
      <p><span style="background-color: initial;">Subscribe to <span style="background-color: initial;">get a weekly email that will get you one step forward to becoming a data scientist.</span></span></p><p><span style="background-color: initial;">Every week, you will get fresh content in your inbox. I cover the topics of Data Analysis in Python, Applied Statistics, Machine Learning, SQL etc.</span></p>
    </div>
  </div>

  <div class="ck_form_fields">
    <div id="ck_success_msg" style="display:none;">
      <p>Thank you! You are now subscribed.</p>
    </div>

    <!--  Form starts here  -->
    <form id="ck_subscribe_form" class="ck_subscribe_form" action="https://forms.convertkit.com/landing_pages/147791/subscribe" data-remote="true">
      <input type="hidden" value="{&quot;form_style&quot;:&quot;full&quot;,&quot;embed_style&quot;:&quot;inline&quot;,&quot;embed_trigger&quot;:&quot;scroll_percentage&quot;,&quot;scroll_percentage&quot;:&quot;70&quot;,&quot;delay_seconds&quot;:&quot;10&quot;,&quot;display_position&quot;:&quot;br&quot;,&quot;display_devices&quot;:&quot;all&quot;,&quot;days_no_show&quot;:&quot;15&quot;,&quot;converted_behavior&quot;:&quot;show&quot;}" id="ck_form_options">
      <input type="hidden" name="id" value="147791" id="landing_page_id">
      <input type="hidden" name="ck_form_recaptcha" value="" id="ck_form_recaptcha">
      <div class="ck_errorArea">
        <div id="ck_error_msg" style="display:none">
          <p>There was an error submitting your subscription. Please try again.</p>
        </div>
      </div>
      <div class="ck_control_group ck_first_name_field_group">
        <label class="ck_label" for="ck_firstNameField">First Name</label>
        <input type="text" name="first_name" class="ck_first_name" id="ck_firstNameField">
      </div>
      <div class="ck_control_group ck_email_field_group">
        <label class="ck_label" for="ck_emailField">Email Address</label>
        <input type="email" name="email" class="ck_email_address" id="ck_emailField" required="">
      </div>
      <div class="ck_control_group ck_captcha2_h_field_group ck-captcha2-h" style="position: absolute !important;left: -999em !important;">
        <label class="ck_label" for="ck_captcha2_h">We use this field to detect spam bots. If you fill this in, you will be marked as a spammer.</label>
        <input type="text" name="captcha2_h" class="ck-captcha2-h" id="ck_captcha2_h">
      </div>

        <label class="ck_checkbox" style="display:none;">
          <input class="optIn ck_course_opted" name="course_opted" type="checkbox" id="optIn" checked="">
          <span class="ck_opt_in_prompt">I'd like to receive the free email course.</span>
        </label>

      <button class="subscribe_button ck_subscribe_button btn fields" id="ck_subscribe_button">
        Subscribe
      </button>
      <span class="ck_guarantee">
         
          <a class="ck_powered_by" href="https://convertkit.com/?utm_campaign=poweredby&amp;utm_content=form&amp;utm_medium=referral&amp;utm_source=dynamic" target="_blank">Powered by ConvertKit</a>
      </span>
    </form>
  </div>

</div>

</div>


<style type="text/css">/* Layout */
  .ck_form {
  /* divider image */
	background: #fff url(data:image/gif;base64,R0lGODlhAQADAIABAMzMzP///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS41LWMwMTQgNzkuMTUxNDgxLCAyMDEzLzAzLzEzLTEyOjA5OjE1ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MUQ5NjM5RjgxQUVEMTFFNEJBQTdGNTQwMjc5MTZDOTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MUQ5NjM5RjkxQUVEMTFFNEJBQTdGNTQwMjc5MTZDOTciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoxRDk2MzlGNjFBRUQxMUU0QkFBN0Y1NDAyNzkxNkM5NyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxRDk2MzlGNzFBRUQxMUU0QkFBN0Y1NDAyNzkxNkM5NyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAEAAAEALAAAAAABAAMAAAICRFIAOw==) repeat-y center top;
	font-family: "Helvetica Neue", Helvetica, Arial, Verdana, sans-serif;
	line-height: 1.5em;
	overflow: hidden;
	color: #666;
	font-size: 16px;
	border-top: solid 20px #3071b0;
  border-top-color: #3071b0;
	border-bottom: solid 10px #3d3d3d;
  border-bottom-color: #1d446a;
	-webkit-box-shadow: 0px 0px 5px rgba(0,0,0,.3);
	-moz-box-shadow: 0px 0px 5px rgba(0,0,0,.3);
	box-shadow: 0px 0px 5px rgba(0,0,0,.3);
	clear: both;
	margin: 20px 0px;
}

.ck_form, .ck_form * {
	-webkit-box-sizing: border-box;
	-moz-box-sizing: border-box;
	box-sizing: border-box;
}

#ck_subscribe_form {
  clear: both;
}

/* Element Queries — uses JS */

.ck_form_content, .ck_form_fields {
	width: 50%;
	float: left;
	padding: 5%;
}

.ck_form.ck_horizontal {
}

.ck_form_content {
	border-bottom: none;
}

.ck_form.ck_vertical {
	background: #fff;
}

.ck_vertical .ck_form_content, .ck_vertical .ck_form_fields {
	padding: 10%;
	width: 100%;
	float: none;
}

.ck_vertical .ck_form_content {
	border-bottom: 1px dotted #aaa;
	overflow: hidden;
}

/* Trigger the vertical layout with media queries as well */

@media all and (max-width: 499px) {

	.ck_form {
		background: #fff;
	}

	.ck_form_content, .ck_form_fields {
		padding: 10%;
		width: 100%;
		float: none;
	}

	.ck_form_content {
		border-bottom: 1px dotted #aaa;
	}

}

/* Content */

.ck_form_content h3 {
	margin: 0px 0px 15px;
	font-size: 24px;
	padding: 0px;
}


.ck_form_content p {
	font-size: 14px;
}

.ck_image {
	float: left;
	margin-right: 5px;
}

/* Form fields */

.ck_errorArea {
	display: none;
}

#ck_success_msg {
	padding: 10px 10px 0px;
	border: solid 1px #ddd;
	background: #eee;
}

.ck_label {
	font-size: 14px;
	font-weight: bold;
}

.ck_form input[type="text"], .ck_form input[type="email"] {
	font-size: 14px;
	padding: 10px 8px;
	width: 100%;
	border: 1px solid #d6d6d6; /* stroke */
	-moz-border-radius: 4px;
	-webkit-border-radius: 4px;
	border-radius: 4px; /* border radius */
	background-color: #f8f7f7; /* layer fill content */
	margin-bottom: 5px;
	height: auto;
}

.ck_form input[type="text"]:focus, .ck_form input[type="email"]:focus {
	outline: none;
	border-color: #aaa;
}

.ck_checkbox {
  padding: 10px 0px 10px 20px;
  display: block;
  clear: both;
}

.ck_checkbox input.optIn {
  margin-left: -20px;
  margin-top: 0;
}
.ck_form .ck_opt_in_prompt {
  margin-left: 4px;
}
.ck_form .ck_opt_in_prompt p {
  display: inline;
}

.ck_form .ck_subscribe_button {
    width: 100%;
    color: #fff;
    margin: 10px 0px 0px;
    padding:  10px 0px;
    font-size: 18px;
    background: #0d6db8;
    -moz-border-radius: 4px;
    -webkit-border-radius: 4px;
    border-radius: 4px; /* border radius */
    cursor: pointer;
    border: none;
    text-shadow: none;
  }


.ck_form .ck_guarantee {
	color: #626262;
	font-size: 12px;
	text-align: center;
	padding: 5px 0px;
	display: block;
}

.ck_form .ck_powered_by {
	display: block;
	color: #aaa;
}

.ck_form .ck_powered_by:hover {
	display: block;
	color: #444;
}

.ck_converted_content {
  display: none;
	padding: 5%;
	background: #fff;
}


/* v6 */

.ck_form_v6 #ck_success_msg {
	padding: 0px 10px;
}

@media all and (max-width: 403px) {
  .ck_form_v6.ck_modal .ck_close_link {
    top: 30px;
  }
}

@media all and (min-width: 404px) and (max-width: 499px) {
  .ck_form_v6.ck_modal .ck_close_link {
    top: 57px;
  }
}



.ck_powered_by { display: none !important; }
.ck_form .ck_subscribe_button { background-color: #057968;}
.ck_form {
    border-top-color: #057968;
    border-bottom-color: #045c4f;
}

</style>
</div><script async="" src="./Tidy Data in Python · Jean-Nicholas Hould_files/147791" id="_ck_147791"></script>
<!-- Convertkit - End -->

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="http://www.jeannicholashould.com/profiling-a-dataset-of-craft-beers.html">
            Profiling a Dataset of Craft Beers
            <small>23 Apr 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="http://www.jeannicholashould.com/what-is-a-data-scientist.html">
            What is a Data Scientist?
            <small>06 Feb 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="http://www.jeannicholashould.com/python-web-scraping-tutorial-for-craft-beers.html">
            Scraping for Craft Beers
            <small>17 Jan 2017</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>


      </div>

      <label for="sidebar-checkbox" class="sidebar-toggle"></label>
    </div>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  

</body></html>